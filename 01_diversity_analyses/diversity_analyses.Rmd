---
title: "Analyses for diversity"
author: "Kelsey Moty"
date: "Last updated November 27, 2018"
output:
  html_document: default
  word_document: default
---
## Loading libraries 
```{r setup, include=FALSE}
library(tidyverse)
library(ordinal) # used for ordinal logistic regressions
library(ucminf) # pretty sure ordinal imports it but will import it explicitly
library(lme4) # ^^^
library(plyr) # pretty sure my helper function uses plyr
library(emmeans) # used for ordinal post-hoc pairwise comparisons
library(here) # for loading data
library(knitr)
```

## Reading in data 
```{r, include=FALSE}
# Read in the data file
dt2 <- here("data", "diversity_fulldataset_cleaned.csv") %>% 
  read_csv() 

# Converting variables to integers 
dt2$exp_choice <- factor(dt2$exp_choice)
dt2$response <- factor(dt2$response)
dt2$age_factor <- factor(dt2$age_factor)
```

## Ordinal logistic regression on full dataset comparing condition by age 
```{r, }
# Ordinal logistic regression using Wald Statistic for comparison
# Testing for the effect of age_exact and condition on response choice
results_clmm <- clmm(response ~ condition + age_factor + age_factor:condition + (1|id)  + (1|item), 
                     data = dt2, 
                     link = "logit", 
                     Hess = TRUE, 
                     threshold = "flexible")
summary(results_clmm)

# Summary() uses the Wald statistic. A more accurate measure of significance is to use likelihood ratio
# To use LR, need to compare models with and without paramter of interest

# Testing if interaction effect is significant
ordinal_int <- drop1(results_clmm, test = "Chi")

# Testing if random effects are significant 
# testing if random effect of participant is significant
results_clmm_fixed <- clmm(response ~ condition + age_factor + age_factor:condition + (1|item), 
                           data = dt2, 
                           link = "logit", 
                           Hess = TRUE, 
                           threshold = "flexible")
anova(results_clmm, results_clmm_fixed)

# testing if random effect of item is significant
results_clmm_fixed1 <- clmm(response ~ condition + age_factor + age_factor:condition + (1|id), 
                            data = dt2, 
                            link = "logit", 
                            Hess = TRUE, 
                            threshold = "flexible")
anova(results_clmm, results_clmm_fixed1)

# Testing if main effects are signficant 
results_clmm_nointeract <- clmm(response ~ condition + age_factor + (1|id) + (1|item), 
                                data = dt2, 
                                link = "logit", 
                                Hess = TRUE, 
                                threshold = "flexible")

ordinal_main <- drop1(results_clmm_nointeract, test = "Chi")
```

## Analyses on Diversity condition
### Analyses with both adult and child data
```{r, include=FALSE}
## ANALYSES USING SUBSET IN DIVERSITY CONDITION ONLY ----
# Make a subset of the data for the diversity condition for effect of experimenter choice
dt2_div <- dt2 %>%
  filter(condition == "diversity") %>% 
  arrange(id)

dt2_div$exp_choice <- factor(dt2_div$exp_choice)
dt2_div$age_factor <- as.factor(dt2_div$age_factor)

# Ordinal logistic regression using Wald Statistic for comparison
results_clmm_div <- clmm(response ~ exp_choice + age_factor + age_factor:exp_choice + (1|id) + (1|item), 
                         data = dt2_div, 
                         link = "logit", 
                         Hess = TRUE, 
                         threshold = "flexible")
summary(results_clmm_div)

# Likelihood ratio tests
# Computing for interaction effect
diversity_int <- drop1(results_clmm_div, test = "Chi")

# Testing of random effect is significant 
# testing if random effect of participant is significant
results_clmm_div_fixed <- clmm(response ~ exp_choice + age_factor + age_factor:exp_choice + (1|item), 
                               data = dt2_div, 
                               link = "logit", 
                               Hess = TRUE, 
                               threshold = "flexible")
anova(results_clmm_div, results_clmm_div_fixed)

# testing if random effect of item is significant
results_clmm_div_fixed1 <- clmm(response ~ exp_choice + age_factor + age_factor:exp_choice + (1|id), 
                                data = dt2_div, 
                                link = "logit", 
                                Hess = TRUE, 
                                threshold = "flexible")
anova(results_clmm_div, results_clmm_div_fixed1)

# Computing for main effects
results_clmm_div_nointeract <- clmm(response ~ exp_choice + age_factor + (1|id) + (1|item), 
                                    data = dt2_div, 
                                    link = "logit", 
                                    Hess = TRUE, 
                                    threshold = "flexible")
diversity_main <- drop1(results_clmm_div_nointeract, test = "Chi")

# Pairwise comparison of age groups 
diversity_pairwise <- summary(lsmeans(results_clmm_div, 
                                      pairwise~age_factor, 
                                      adjust="sidak", 
                                      mode = "mean.class"))
```

### Analyses with just children's data
```{r, include=FALSE}
# separate dvs for child data
dt2_div_c <- dt2_div %>% 
  filter(age_factor != "adult")

#### Can do age_factor or age_exact. Here it is age_exact
# Ordinal logistic regression using Wald Statistic for comparison
results_clmm_div_c <- clmm(response ~ exp_choice + age_exact + age_exact:exp_choice + (1|id) + (1|item), 
                         data = dt2_div_c, 
                         link = "logit", 
                         Hess = TRUE, 
                         threshold = "flexible")
summary(results_clmm_div_c)

# Likelihood ratio tests
# Computing for interaction effect
diversity_int_children <- drop1(results_clmm_div_c, test = "Chi")

# Testing of random effect is significant 
# testing if random effect of participant is significant
results_clmm_div_fixed_c <- clmm(response ~ exp_choice + age_exact + age_exact:exp_choice + (1|item), 
                                 data = dt2_div_c, 
                                 link = "logit", 
                                 Hess = TRUE, 
                                 threshold = "flexible")
anova(results_clmm_div_c, results_clmm_div_fixed_c)

# testing if random effect of item is significant
results_clmm_div_fixed1_c <- clmm(response ~ exp_choice + age_exact + age_exact:exp_choice + (1|id), 
                                  data = dt2_div_c, 
                                  link = "logit", 
                                  Hess = TRUE, 
                                  threshold = "flexible")
anova(results_clmm_div_c, results_clmm_div_fixed1_c)

# Computing for main effects
results_clmm_div_nointeract_c <- clmm(response ~ exp_choice + age_exact + (1|id) + (1|item), 
                                      data = dt2_div_c, 
                                      link = "logit", 
                                      Hess = TRUE, 
                                      threshold = "flexible")
diversity_main_children <- drop1(results_clmm_div_nointeract_c, test = "Chi")
```

### Analyses for children's data broken down by experimenter choice
```{r, include=FALSE}
# Separate dfs for child data for each exp_choice
dt2_div_c5 <- dt2_div_c %>% 
  filter(exp_choice == "5")

dt2_div_c4 <- dt2_div_c %>% 
  filter(exp_choice == "4")

dt2_div_c3 <- dt2_div_c %>% 
  filter(exp_choice == "3")

dt2_div_c2 <- dt2_div_c %>% 
  filter(exp_choice == "2")

dt2_div_c1 <- dt2_div_c %>% 
  filter(exp_choice == "1")

# Looking at effect of continuous age on response separately for each experimenter response
# can't do LRT for single fixed effect so putting item as fixed effect instead of random
results_clmm_divc1 <- clm(response ~ age_exact + item, 
                           data = dt2_div_c1, 
                           link = "logit", 
                           Hess = TRUE, 
                           threshold = "flexible")
div_exp1 <- drop1(results_clmm_divc1, test = "Chi")

results_clmm_divc2 <- clm(response ~ age_exact + item, 
                           data = dt2_div_c2, 
                           link = "logit", 
                           Hess = TRUE, 
                           threshold = "flexible")
div_exp2 <- drop1(results_clmm_divc2, test = "Chi")

results_clmm_divc3 <- clm(response ~ age_exact + item, 
                           data = dt2_div_c3, 
                           link = "logit", Hess = TRUE, threshold = "flexible")
div_exp3 <- drop1(results_clmm_divc3, test = "Chi")

results_clmm_divc4 <- clm(response ~ age_exact + item, 
                           data = dt2_div_c4, 
                           link = "logit", 
                           Hess = TRUE, 
                           threshold = "flexible")
div_exp4 <- drop1(results_clmm_divc4, test = "Chi")

results_clmm_divc5 <- clm(response ~ age_exact + item, 
                           data = dt2_div_c5, 
                           link = "logit", 
                           Hess = TRUE, 
                           threshold = "flexible")
div_exp5 <- drop1(results_clmm_divc5, test = "Chi")
```


### Helping function to get confindence intervals
```{r, include=FALSE}
here("summarySE.R") %>% source()

dt2_div_numeric <- dt2_div
dt2_div_numeric$response <- as.numeric(dt2_div_numeric$response)
summarySE(dt2_div_numeric, measurevar = "response", groupvars = c("age_factor", "exp_choice"))

data_summary <- summarySE(dt2_div_numeric, 
                          measurevar = "response",
                          groupvars = c("age_factor", 
                                        "exp_choice")
)
```

## Plotting diversity condition data

### one plot idea that I started testing out but ultimately didn't do much with
```{r, include=FALSE}
plot_diversity <- ggplot(data = dt2_div_c) + 
  facet_grid (
    . ~ exp_choice
  ) +
  # scale_y_continuous(expand = c(0, 0)
  # ) +
  coord_cartesian(ylim=c(0.9,5.1)
  ) + 
  labs(x = "Age",
       y = "Average Response"
  ) +
  theme(text         = element_text(size = 14),
        axis.title.x = element_text(size = 14, 
                                    face = "bold",
                                    margin = margin(t = 20, r = 0, b = 0, l = 0)),
        axis.title.y = element_text(size = 14, 
                                    face = "bold",
                                    margin = margin(t = 0, r = 20, b = 0, l = 0)),
        strip.text = element_text(size = 12),
        strip.background = element_blank(),
        panel.border = element_rect(color = "black", fill = NA),
        panel.background = element_rect(fill = NA)
  ) +
  # geom_point(data = dt_div_for_graphs, 
  #            aes(y = response, x = exp_choice),
  #            position = position_jitter(w = 0.25, h = 0),
  #            shape = 1,
  #            size = 2) +
  geom_point(aes(x = age_exact, y = response, color=age_factor),
             shape = 16,
             size = 1,
             position = position_jitter(w = 0, h = 0.1)
  ) 
plot_diversity
```

### This plot treats age categorically. 

Plot has age groups separated into four panels. X-axis is experimenter choice
```{r, include=FALSE}
# separte df for plotting
dt_div_for_graphs <- dt2_div
dt_div_for_graphs$response <- as.integer(dt_div_for_graphs$response)

# the plot
plot_diversity <- ggplot(data = data_summary) + 
  facet_grid (
    . ~ age_factor
  ) +
  scale_y_continuous(expand = c(0, 0)
  ) +
  coord_cartesian(ylim=c(0.9,5.1)
  ) + 
  labs(x = "Experimenter Choice",
       y =" Average Response"
  ) +
  theme(text         = element_text(size = 14),
        axis.title.x = element_text(size = 14, 
                                    face = "bold",
                                    margin = margin(t = 20, r = 0, b = 0, l = 0)),
        axis.title.y = element_text(size = 14, 
                                    face = "bold",
                                    margin = margin(t = 0, r = 20, b = 0, l = 0)),
        strip.text = element_text(size = 12),
        strip.background = element_blank(),
        panel.border = element_rect(color = "black", fill = NA),
        panel.background = element_rect(fill = NA)
  ) +
  geom_point(data = dt_div_for_graphs, 
             aes(y = response, x = exp_choice),
             position = position_jitter(w = 0.25, h = 0),
             shape = 1,
             size = 2) +
  geom_point(aes(x = exp_choice, y = measurevar, color=age_factor),
             shape = 16,
             size = 7
  ) 
plot_diversity
```

### This plot treats age continuously and plots across 5 panels, participant response for each of the 5 experimenter choices

```{r, }
# creating separate df for plotting
plot_continuous_data <- dt_div_for_graphs

# making adults exact 13 -- this will be used to graph adults categorically. Can make bigger or smaller number depending on if we want te adult data to be plotted closer or farther from children's data
plot_continuous_data$age_exact <- ifelse(plot_continuous_data$age_exact > 18, 13, plot_continuous_data$age_exact) 
# creating a separate grouping column that categories participants as adult or child; this is used later to assign different shapes to adult/child participants in plots
plot_continuous_data$adult <- ifelse(plot_continuous_data$age_factor == "adult", "adult", "child")

# one adult doesn't have an exact age, so filling it in
plot_continuous_data$age_exact <- ifelse(is.na(plot_continuous_data$age_exact), 13, plot_continuous_data$age_exact)

plot_cont_adult <- plot_continuous_data %>% filter(age_exact == 13)
plot_cont_child <- plot_continuous_data %>% filter(age_exact != 13)

# the plot
plot_continuous <- ggplot() + 
  facet_grid (
    . ~ exp_choice
  ) +
  geom_point(data = plot_cont_child,
             aes(y = response, x = age_exact),
             position = position_jitter(w = 0, h = 0.1),
             size = 2,
             shape = 1,
             alpha = .4
  ) + 
  geom_smooth(data = plot_cont_child,
              aes(y = response, x = age_exact),
              method = lm,
              color = "black",
              fill = "#009E73"
  ) +
  geom_point(data = plot_cont_adult,
           aes(y = response, x = age_exact),
           position = position_jitter(w = 0.2, h = 0.1),
           size = 2,
           shape = 2,
           alpha = .4
  ) + 
  # scale_shape_manual(
  #   values = c(2,1)
  # ) +
  scale_y_continuous(expand = c(0, 0)
  ) +
  scale_x_continuous(breaks = c(5, 7, 9, 11, 13), 
                     labels = c("5", "7", "9", "11", "Adults")
  ) +
  coord_cartesian(ylim=c(0.9,5.1),
                  xlim=c(4.9,14)
  ) + 
  labs(x = "Age",
       y = "Participants' Responses",
       title = "Experimenter's Selection"
       
  ) +
  theme(text         = element_text(size = 14),
        plot.title   = element_text(size = 14,
                                    face = "bold",
                                    hjust = .5),
        axis.title.x = element_text(size = 14, 
                                    face = "bold",
                                    margin = margin(t = 20, r = 0, b = 0, l = 0)),
        axis.title.y = element_text(size = 14, 
                                    face = "bold",
                                    margin = margin(t = 0, r = 20, b = 0, l = 0)),
        strip.text = element_text(size = 12),
        strip.background = element_blank(),
        panel.border = element_rect(color = "black", fill = NA),
        panel.background = element_rect(fill = NA)
  ) + 
  guides(shape = FALSE)

plot_continuous
```



## Analyzing control condition data

```{r, include=FALSE}
# creating separate df with just control data
dt2_control <- dt2 %>%
  filter(condition == "control") %>% 
  arrange(id)

# separate df of just control data for kids; useful for analyzes where we want to explore age continuously
dt2_control_c <- dt2_control %>% 
  filter(age_factor != "adult")

# making sure age is set to factor
dt2_control$age_factor <- as.factor(dt2_control$age_factor)

# column dichotomozing kids and adults (if we want to run separate OLR for adult vs kids)
dt2_control$adult <- ifelse(dt2_control$age_factor == "adult", "adult", "child")

# Ordinal logistic regression using Wald Statistic for comparison
results_clmm_div <- clmm(response ~ age_factor + (1|id) + (1|item), 
                         data = dt2_control, 
                         link = "logit", 
                         Hess = TRUE, threshold = "flexible")
summary(results_clmm_div)

# Likelihood ratio tests
# to get the likelihood ratio, you can't in R do it with only one fixed effect. To get around that, the best approximate is to treat one of the random effects as fixed and then do the drop1()
results_clmm_div1 <- clmm(response ~ age_factor + (1|id) + item, 
                          data = dt2_control, 
                          link = "logit", 
                          Hess = TRUE, 
                          threshold = "flexible")
control_main <- drop1(results_clmm_div1, test = "Chi")

# Testing of random effect is significant 
# testing if random effect of participant is significant
results_clmm_div_fixed <- clmm(response ~ age_factor + (1|item), data = dt2_control, 
                              link = "logit", Hess = TRUE, threshold = "flexible")
anova(results_clmm_div, results_clmm_div_fixed)

# testing if random effect of item is significant
results_clmm_div_fixed1 <- clmm(response ~ age_factor + (1|id), data = dt2_control, 
                              link = "logit", Hess = TRUE, threshold = "flexible")
anova(results_clmm_div, results_clmm_div_fixed1)


# Testing with just kid data
results_clmm_div_control_c <- clmm(response ~ age_exact + (1|id) + item, 
                                   data = dt2_control_c, 
                                   link = "logit", 
                                   Hess = TRUE, 
                                   threshold = "flexible")
control_main_children <- drop1(results_clmm_div_control_c , test = "Chi")

```

## Control condition without skunk
```{r}
dt2_control_noskunk <- dt2_control %>% filter(item != "skunk")
dt2_control_noskunk_children <- dt2_control_noskunk %>% filter(adult == "child")

results_clmm_div_noskunk <- clmm(response ~ age_factor + (1|id) + item, 
                                 data = dt2_control_noskunk, 
                                 link = "logit", 
                                 Hess = TRUE, 
                                 threshold = "flexible")
control_main_noskunk <- drop1(results_clmm_div_noskunk, test = "Chi")

round(control_main_noskunk[2,4],3)
```

## Control condition controlling for item valence
```{r}
dt2_control_valence <- dt2_control %>% 
  mutate(valence = ifelse(item == "cheetah" | item == "giraffe", "positive", "negative"))
dt2_control_valence_children <- dt2_control_valence %>% filter(adult == "child")

results_clmm_div_valence <- clmm(response ~ age_exact + (1|id) + valence, 
                                 data = dt2_control_valence_children, 
                                 link = "logit", 
                                 Hess = TRUE, 
                                 threshold = "flexible")
control_main_valence <- drop1(results_clmm_div_valence, test = "Chi")

round(control_main_valence[2,4],3)
```


## Control condition plot

This plot treats age as continuous for children participants but groups adults categorically 
```{r, include=FALSE}
# pulling control data into a new data frame to manipulate for designing plots
plot_continuous_data_control <- dt2_control_noskunk
plot_continuous_data_control$response <- as.integer(plot_continuous_data_control$response)

# making adults exact 12 -- this will be used to graph adults categorically. Can make bigger or smaller number depending on if we want te adult data to be plotted closer or farther from children's data
plot_continuous_data_control$age_exact <- ifelse(plot_continuous_data_control$age_exact > 18, 12, plot_continuous_data_control$age_exact) 

# creating a separate grouping column that categories participants as adult or child; this is used later to assign different shapes to adult/child participants in plots
plot_continuous_data_control$adult <- ifelse(plot_continuous_data_control$age_factor == "adult", "adult", "child")

# one adult doesn't have an exact age, so filling it in
plot_continuous_data_control$age_exact <- ifelse(is.na(plot_continuous_data_control$age_exact), 12, plot_continuous_data_control$age_exact)

# the plot
plot_continuous_control <- ggplot(data = plot_continuous_data_control) + 
  geom_point(aes(y = response, x = age_exact, shape = adult),
           position = position_jitter(w = 0, h = 0.1),
           size = 2,
           alpha = .4
  ) + 
  geom_smooth(aes(y = response, x = age_exact, shape = adult),
              method = lm,
              color = "black",
              fill = "#009E73"
  ) +
  scale_shape_manual(
    values = c(3,1)
  ) +
  scale_y_continuous(expand = c(0, 0)
  ) +
  scale_x_continuous(breaks = c(5, 7, 9, 11, 12), 
                     labels = c("5", "7", "9", "11", "Adults")
  ) +
  coord_cartesian(ylim=c(0.9,5.1)
  ) + 
  labs(x = "Age",
       y = "Participants' Responses"
  ) +
  theme(text         = element_text(size = 14),
        axis.title.x = element_text(size = 14, 
                                    face = "bold",
                                    margin = margin(t = 20, r = 0, b = 0, l = 0)),
        axis.title.y = element_text(size = 14, 
                                    face = "bold",
                                    margin = margin(t = 0, r = 20, b = 0, l = 0)),
        strip.text = element_text(size = 12),
        strip.background = element_blank(),
        panel.border = element_rect(color = "black", fill = NA),
        panel.background = element_rect(fill = NA)
  ) + 
  guides(shape = FALSE)

plot_continuous_control
```


## Results section 

  We analyzed participants' choices on the animal scales using an ordinal logistic regression. For analyses that include adult participants, we treated age as a categorical variable; for comparable analyses with children participants only, we treated age as a continuous variable. We report the results of likelihood ratio tests and means with 95% confidence intervals.
	
	When examining children's and adults' responses across both conditions, we found a marginal interaction between participant age and condition ($\chi^2$(`r ordinal_int$Df[2]`) = `r ordinal_int$LRT[2]`, *p* = `r round(ordinal_int[2,4], 3)`) as well as a significant main effect of age ($\chi^2$(`r ordinal_main$Df[3]`) = `ordinal_main$LRT[3]`, *p* = `r round(ordinal_main[3,4], 3)`) and marginal main effect for condition ($\chi^2$(`r ordinal_main$Df[2]`) = `ordinal_main$LRT[2]`, *p* = `r round(ordinal_main[2,4], 3)`). 
	
  Within the diversity condition, the range of responses participants considered in their samples to learn about the animal kinds showed main effects of age ($\chi^2$(`r diversity_main$Df[3]`) = `r diversity_main$LRT[3]`, *p* < `r ifelse(diversity_main[3,4] < .001, .001, round(diversity_main[3,4],3))`) and experimenter choice ($\chi^2$(`r diversity_main$Df[2]`) = `r diversity_main$LRT[2]`, *p* < `r ifelse(diversity_main[2,4] < .001, .001, round(diversity_main[2,4],3))`) subsumed by a near significant interaction effect between age and experimenter choice (($\chi^2$(`r diversity_int$Df[3]`) = `r diversity_int$LRT[3]`, *p* < `r ifelse(diversity_int[2,4] < .001, .001, round(diversity_int[2,4],3))`)). When the experimenter chose the least extreme exemplar as the first element in the sample (exemplar 1 on the scale, e.g., the slowest cheetah), children of all ages and adults selected maximally extreme and, therefore, maximally diverse exemplars as the second element in the sample (Ages 5-6: *M* = `r round(data_summary$measurevar[1],2)`, 95% CI [`r round(data_summary$measurevar[1]-data_summary$ci[1],2)`, `r round(data_summary$measurevar[1]+data_summary$ci[1],2)`]; Ages 7-8: *M* = `r round(data_summary$measurevar[6],2)`, 95% CI [`r round(data_summary$measurevar[6]-data_summary$ci[6],2)`, `r round(data_summary$measurevar[6]+data_summary$ci[6],2)`]; Ages 9-10: *M* = `r round(data_summary$measurevar[11],2)`, 95% CI [`r round(data_summary$measurevar[11]-data_summary$ci[11],2)`, `r round(data_summary$measurevar[11]+data_summary$ci[11],2)`]; Adults: *M* = `r round(data_summary$measurevar[16],2)`, 95% CI [`r round(data_summary$measurevar[16]-data_summary$ci[16],2)`, `r round(data_summary$measurevar[16]+data_summary$ci[16],2)`]; see Figure 2). However, when the experimenter selected the most extreme exemplar as the first element in the sample (exemplar 5 on the scale, e.g., the fastest cheetah), younger children selected more extreme and, therefore, less diverse exemplars as the second element in the sample (Ages 5-6: *M* = `r round(data_summary$measurevar[5],2)`, 95% CI [`r round(data_summary$measurevar[5]-data_summary$ci[5],2)`, `r round(data_summary$measurevar[5]+data_summary$ci[5],2)`]; Ages 7-8: *M* = `r round(data_summary$measurevar[10],2)`, 95% CI [`r round(data_summary$measurevar[10]-data_summary$ci[10],2)`, `r round(data_summary$measurevar[10]+data_summary$ci[10],2)`]; Ages 9-10: *M* = `r round(data_summary$measurevar[15],2)`, 95% CI [`r round(data_summary$measurevar[15]-data_summary$ci[15],2)`, `r round(data_summary$measurevar[15]+data_summary$ci[15],2)`]; Adults: *M* = `r round(data_summary$measurevar[20],2)`, 95% CI [`r round(data_summary$measurevar[20]-data_summary$ci[20],2)`, `r round(data_summary$measurevar[20]+data_summary$ci[20],2)`]) chose less extreme, more diverse, exemplars. In this way, younger children's preferred samples that were both less diverse and more extreme than those preferred by older and adults. Pairwise comparisons using the Sidak correction for multiple comparisons revealed that 7-8 year olds chose significantly less diverse samples than 9-10 year olds (*t* = `r round(diversity_pairwise$contrasts$estimate[4],3)`, *SE* = `r round(diversity_pairwise$contrasts$SE[4],3)`, *p* = `r round(diversity_pairwise$contrasts$p.value[4],3)`) but did not differ significantly from 5-6 year olds (*t* = `r round(diversity_pairwise$contrasts$estimate[1],3)`, *SE* = `r round(diversity_pairwise$contrasts$SE[1],3)`, *p* = `r round(diversity_pairwise$contrasts$p.value[1],3)`). The patterns of responses in 9-10 year olds did not differ significantly from those of adults (*t* = `r round(diversity_pairwise$contrasts$estimate[6],3)`, *SE* = `r round(diversity_pairwise$contrasts$SE[6],3)`, *p* = `r round(diversity_pairwise$contrasts$p.value[6],3)`).
  
  We found that these age-related changes in sample selection strategies holds even when only examining data from child participants. Here, we  included children's exact age in the model and treated age as a continuous variable. Children across all ages similarly chose the most extreme animal (exemplar 5 on the scale) when the experimenter selects the least extreme exemplar (exemplar 1; $\chi^2$(`r div_exp1$Df[2]`) = `r round(div_exp1$LRT[2],3)`, *p* = `r round(div_exp1[2,4],3)`). However, while younger children continue to select more extreme exemplars regardless of the experimenter's choice, older children vary their selections in accordance with the experimenter's choice (when experimenter selects exemplar 2: $\chi^2$(`r div_exp2$Df[2]`) = `r round(div_exp2$LRT[2],3)`, *p* = `r round(div_exp2[2,4],3)`; exemplar 3: $\chi^2$(`r div_exp3$Df[2]`) = `r round(div_exp3$LRT[2],3)`, *p* = `r round(div_exp3[2,4],3)`; exemplar 4: $\chi^2$(`r div_exp4$Df[2]`) = `r round(div_exp4$LRT[2],3)`, *p* = `r round(div_exp4[2,4],3)`; exemplar 5: $\chi^2$(`r div_exp5$Df[2]`) = `r round(div_exp5$LRT[2],3)`, *p* = `r round(div_exp5[2,4],3)`). 
  
  Turning to participants' responses in the control condition, we did not find an effect of age on in participants' sample selections in the control condition, neither when adults were included in the model ($\chi^2$(`r control_main$Df[2]`) = `r round(control_main$LRT[2],3)`, *p* = `r round(control_main[2,4],3)`) nor when we examined just the children's responses ($\chi^2$(`r control_main_children$Df[2]`) = `r round(control_main_children$LRT[2],3)`, *p* = `r round(control_main_children[2,4],3)`). That is, when participants did not work with the experimenter to select two animals but instead only chose one animal from the scale, participants across all ages similarly chose between the most extreme exemplars (exemplar 5 on the scale, e.g., the fastest cheetah) and the average exemplar (exemplar 3 on the scale, e.g., neither the fastest nor slowest cheetah). This finding was surprising and different from what we have found in previous work (CITATION).  



